# Nginx configuration for layout reference file uploads
# Include this in your main nginx site configuration

# Layout reference uploads location
location /uploads/layouts/ {
    # Serve files from local storage directory
    alias /srv/uploads/layouts/;
    
    # Security: Allow PDFs and images
    types {
        application/pdf pdf;
        image/png png;
        image/jpeg jpg jpeg;
        image/webp webp;
    }
    default_type application/octet-stream;
    
    # Disable execution of scripts
    location ~ \.(php|py|sh|exe)$ {
        deny all;
    }
    
    # Cache static files
    expires 30d;
    add_header Cache-Control "public, immutable";
    
    # Security headers
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options DENY;
    
    # Logging
    access_log /var/log/nginx/layout_uploads_access.log;
    error_log /var/log/nginx/layout_uploads_error.log;
}

# Allow larger uploads for layout PDFs (up to 10MB)
# Note: This should be set at the server or http level in your main nginx config
# client_max_body_size 10M;
