# Nginx configuration for logo file storage
# Include this in your main nginx site configuration

# Logo uploads location
location /uploads/logos/ {
    # Serve files from local storage directory
    alias /srv/uploads/logos/;
    
    # Security: Only allow image files
    types {
        image/png png;
        image/jpeg jpg jpeg;
        image/gif gif;
        image/webp webp;
    }
    default_type application/octet-stream;
    
    # Disable execution of scripts
    location ~ \.php$ {
        deny all;
    }
    
    # Cache static files
    expires 30d;
    add_header Cache-Control "public, immutable";
    
    # Security headers
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options DENY;
    
    # Enable CORS if needed (adjust origins as needed)
    # add_header Access-Control-Allow-Origin "*";
    
    # Logging
    access_log /var/log/nginx/uploads_access.log;
    error_log /var/log/nginx/uploads_error.log;
}

# Maximum upload file size (applies to all uploads)
# Increased to 10M to support PDF and large image uploads for layout builder
client_max_body_size 10M;

# Optional: Redirect old paths if migrating from different storage
# location /old-logos/ {
#     rewrite ^/old-logos/(.*)$ /uploads/logos/$1 permanent;
# }
